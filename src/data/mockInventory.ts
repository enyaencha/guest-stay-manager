import { InventoryItem, StockAlert } from '@/types/inventory';

// Real inventory data from STOCK AS AT 1ST JANUARY 2026.xlsx
// Data reflects actual stock levels at Rest Perk Limited

export const mockInventoryItems: InventoryItem[] = [
  // Guest Amenities - from stock sheet
  {
    id: '1',
    name: 'Tissues',
    brand: 'Generic',
    category: 'amenities',
    sku: 'AMN-TIS-001',
    currentStock: 80,
    minStock: 100,
    maxStock: 300,
    unit: 'packs',
    unitCost: 20,
    sellingPrice: 0,
    lastRestocked: '2026-01-01',
    supplier: 'Local Supplier',
    openingStock: 218,
    purchasesIn: 0,
    stockOut: 138,
  },
  {
    id: '2',
    name: 'Sawa Soap',
    brand: 'Sawa',
    category: 'bathroom',
    sku: 'BTH-SWS-001',
    currentStock: 432,
    minStock: 200,
    maxStock: 600,
    unit: 'pieces',
    unitCost: 6.15,
    sellingPrice: 0,
    lastRestocked: '2026-01-16',
    supplier: 'Wholesale Supplier',
    openingStock: 269,
    purchasesIn: 432,
    stockOut: 269,
  },
  {
    id: '3',
    name: 'Water 1LT',
    brand: 'Generic',
    category: 'kitchen',
    sku: 'KIT-W1L-001',
    currentStock: 12,
    minStock: 50,
    maxStock: 150,
    unit: 'bottles',
    unitCost: 33.33,
    sellingPrice: 100,
    lastRestocked: '2026-01-01',
    supplier: 'Beverage Supplier',
    openingStock: 42,
    purchasesIn: 0,
    stockOut: 30,
  },
  {
    id: '4',
    name: 'Water 500ML (Sales)',
    brand: 'Generic',
    category: 'kitchen',
    sku: 'KIT-W5S-001',
    currentStock: 72,
    minStock: 50,
    maxStock: 200,
    unit: 'bottles',
    unitCost: 16.67,
    sellingPrice: 50,
    lastRestocked: '2026-01-02',
    supplier: 'Beverage Supplier',
    openingStock: 88,
    purchasesIn: 48,
    stockOut: 64,
  },
  {
    id: '5',
    name: 'Water 500ML (Rooms)',
    brand: 'Generic',
    category: 'amenities',
    sku: 'AMN-W5R-001',
    currentStock: 0,
    minStock: 50,
    maxStock: 200,
    unit: 'bottles',
    unitCost: 16.67,
    sellingPrice: 0,
    lastRestocked: '2026-01-01',
    supplier: 'Beverage Supplier',
    openingStock: 0,
    purchasesIn: 0,
    stockOut: 0,
  },
  {
    id: '6',
    name: 'Trust Condoms',
    brand: 'Trust',
    category: 'amenities',
    sku: 'AMN-TRS-001',
    currentStock: 72,
    minStock: 30,
    maxStock: 150,
    unit: 'packs',
    unitCost: 24.58,
    sellingPrice: 100,
    lastRestocked: '2026-01-16',
    supplier: 'Pharmacy Supplier',
    openingStock: 52,
    purchasesIn: 48,
    stockOut: 28,
  },
  {
    id: '7',
    name: 'Vaseline',
    brand: 'Vaseline',
    category: 'amenities',
    sku: 'AMN-VAS-001',
    currentStock: 24,
    minStock: 20,
    maxStock: 80,
    unit: 'pieces',
    unitCost: 38.33,
    sellingPrice: 50,
    lastRestocked: '2026-01-16',
    supplier: 'Pharmacy Supplier',
    openingStock: 16,
    purchasesIn: 24,
    stockOut: 16,
  },
  {
    id: '8',
    name: 'Toothpaste & Brush Kit',
    brand: 'Generic',
    category: 'amenities',
    sku: 'AMN-TPB-001',
    currentStock: 114,
    minStock: 50,
    maxStock: 200,
    unit: 'sets',
    unitCost: 20,
    sellingPrice: 50,
    lastRestocked: '2026-01-01',
    supplier: 'Pharmacy Supplier',
    openingStock: 137,
    purchasesIn: 0,
    stockOut: 23,
  },
  {
    id: '9',
    name: 'Soda 500ML',
    brand: 'Coca-Cola',
    category: 'kitchen',
    sku: 'KIT-SOD-001',
    currentStock: 24,
    minStock: 50,
    maxStock: 150,
    unit: 'bottles',
    unitCost: 61.46,
    sellingPrice: 100,
    lastRestocked: '2026-01-01',
    supplier: 'Beverage Supplier',
    openingStock: 43,
    purchasesIn: 0,
    stockOut: 19,
  },
  {
    id: '10',
    name: 'Predator Energy 500ML',
    brand: 'Predator',
    category: 'kitchen',
    sku: 'KIT-PRE-001',
    currentStock: 0,
    minStock: 20,
    maxStock: 60,
    unit: 'bottles',
    unitCost: 54.17,
    sellingPrice: 100,
    lastRestocked: '2026-01-01',
    supplier: 'Beverage Supplier',
    openingStock: 11,
    purchasesIn: 0,
    stockOut: 11,
  },
  {
    id: '11',
    name: 'Panadol Extra',
    brand: 'Panadol',
    category: 'amenities',
    sku: 'AMN-PAN-001',
    currentStock: 100,
    minStock: 50,
    maxStock: 200,
    unit: 'tablets',
    unitCost: 5.50,
    sellingPrice: 30,
    lastRestocked: '2026-01-01',
    supplier: 'Pharmacy Supplier',
    openingStock: 120,
    purchasesIn: 0,
    stockOut: 20,
  },
  {
    id: '12',
    name: 'Mara Moja',
    brand: 'Mara Moja',
    category: 'amenities',
    sku: 'AMN-MAR-001',
    currentStock: 100,
    minStock: 50,
    maxStock: 200,
    unit: 'tablets',
    unitCost: 3.55,
    sellingPrice: 20,
    lastRestocked: '2026-01-01',
    supplier: 'Pharmacy Supplier',
    openingStock: 118,
    purchasesIn: 0,
    stockOut: 18,
  },
  {
    id: '13',
    name: 'VIM Cleaning Powder',
    brand: 'VIM',
    category: 'cleaning',
    sku: 'CLN-VIM-001',
    currentStock: 12,
    minStock: 10,
    maxStock: 30,
    unit: 'containers',
    unitCost: 94.58,
    sellingPrice: 0,
    lastRestocked: '2026-01-01',
    supplier: 'Cleaning Supplies Ltd',
    openingStock: 13,
    purchasesIn: 0,
    stockOut: 1,
  },
];

// Stock summary from Excel:
// Total Opening Stock: 1,127 units valued at KSH 19,059
// Total Purchases: 552 units valued at KSH 5,555
// Total Stock Out: 637 units with sales value of KSH 14,430
// Closing Balance: 1,042 units

export const stockSummaryJan2026 = {
  openingStockUnits: 1127,
  openingStockValue: 19059,
  purchasesUnits: 552,
  purchasesValue: 5555,
  stockOutUnits: 637,
  stockOutSalesValue: 14430,
  closingBalanceUnits: 1042,
};

export const getStockLevel = (item: InventoryItem): 'out-of-stock' | 'low' | 'adequate' | 'full' => {
  if (item.currentStock === 0) return 'out-of-stock';
  if (item.currentStock < item.minStock) return 'low';
  if (item.currentStock >= item.maxStock * 0.8) return 'full';
  return 'adequate';
};

export const getStockAlerts = (items: InventoryItem[]): StockAlert[] => {
  return items
    .filter(item => item.currentStock < item.minStock)
    .map(item => ({
      id: `alert-${item.id}`,
      itemId: item.id,
      itemName: item.name,
      category: item.category,
      currentStock: item.currentStock,
      minStock: item.minStock,
      level: (item.currentStock < item.minStock * 0.5 ? 'critical' : 'warning') as 'critical' | 'warning',
      createdAt: new Date().toISOString(),
    }))
    .sort((a, b) => (a.level === 'critical' ? -1 : 1));
};

// Calculate total stock value
export const calculateStockValue = (items: InventoryItem[]): number => {
  return items.reduce((total, item) => total + (item.currentStock * item.unitCost), 0);
};

// Calculate potential sales value
export const calculatePotentialSalesValue = (items: InventoryItem[]): number => {
  return items
    .filter(item => item.sellingPrice && item.sellingPrice > 0)
    .reduce((total, item) => total + (item.currentStock * (item.sellingPrice || 0)), 0);
};
